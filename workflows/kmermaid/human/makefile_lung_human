all_bam: run_lung1 run_lung2 run_lung3

run_lung1:
	bam2fasta make_fastqs_percell \
		--filename /mnt/ibm_lg/pranathi/immune-evolution/human-kmermaid-ndnd-september15/10x-fastqs/per-channel/aligned/TSP1_lung_1_possorted_genome_bam__aligned.fastq.gz \
		--barcodes-significant-umis-file /mnt/ibm_lg/pranathi/immune-evolution/human-kmermaid-ndnd-september15/10x-fastqs/umis-per-cell/TSP1_lung_1_possorted_genome_bam__aligned__barcodes.tsv \
		--cell-barcode-pattern '(CB|XC):Z:([ACGT]+)(\-1)?' \
		--channel-id TSP1_lung_1_possorted_genome_bam__aligned__ \
		--output-format 'fastq.gz' \
		--save-fastas /mnt/ibm_lg/pranathi/immune-evolution/human-kmermaid-ndnd-september15/10x-fastqs/per-cell/TSP1_lung_1_possorted_genome_bam/

run_lung2:
	bam2fasta make_fastqs_percell \
		--filename /mnt/ibm_lg/pranathi/immune-evolution/human-kmermaid-ndnd-september15/10x-fastqs/per-channel/aligned/TSP1_lung_2_possorted_genome_bam__aligned.fastq.gz \
		--barcodes-significant-umis-file /mnt/ibm_lg/pranathi/immune-evolution/human-kmermaid-ndnd-september15/10x-fastqs/umis-per-cell/TSP1_lung_2_possorted_genome_bam__aligned__barcodes.tsv \
		--cell-barcode-pattern '(CB|XC):Z:([ACGT]+)(\-1)?' \
		--channel-id TSP1_lung_2_possorted_genome_bam__aligned__  \
		--output-format 'fastq.gz' \
		--save-fastas /mnt/ibm_lg/pranathi/immune-evolution/human-kmermaid-ndnd-september15/10x-fastqs/per-cell/TSP1_lung_2_possorted_genome_bam/

run_lung3:
	bam2fasta make_fastqs_percell \
		--filename /mnt/ibm_lg/pranathi/immune-evolution/human-kmermaid-ndnd-september15/10x-fastqs/per-channel/aligned/TSP1_lung_3_possorted_genome_bam__aligned.fastq.gz \
		--barcodes-significant-umis-file /mnt/ibm_lg/pranathi/immune-evolution/human-kmermaid-ndnd-september15/10x-fastqs/umis-per-cell/TSP1_lung_3_possorted_genome_bam__aligned__barcodes.tsv \
		--cell-barcode-pattern '(CB|XC):Z:([ACGT]+)(\-1)?' \
		--channel-id TSP1_lung_3_possorted_genome_bam__aligned__ \
		--output-format 'fastq.gz' \
		--save-fastas /mnt/ibm_lg/pranathi/immune-evolution/human-kmermaid-ndnd-september15/10x-fastqs/per-cell/TSP1_lung_3_possorted_genome_bam/


run_kmermaid_lung:
	nextflow run nf-core/kmermaid -r pranathivemuri-patch-1 -latest \
		--read_singles '/mnt/ibm_lg/pranathi/immune-evolution/human-kmermaid-ndnd-september15/10x-fastqs/per-cell/*lung*/*.fastq.gz' \
		--reference_proteome_fasta /home/olga/data_lg/czbiohub-reference/uniprot/releases/2019_11/manually_downloaded/uniprot-reviewed_yes+taxonomy_Mammalia_9MAMM_40674.fasta.gz  \
		--translate_peptide_ksize 11 \
		--translate_peptide_molecule protein \
		-with-tower \
		-work-dir /mnt/ibm_lg/pranathi/human-kmermaid-lung-oct5/ \
		--outdir /mnt/ibm_lg/pranathi/immune-evolution/human-kmermaid-lung-oct5 \
		-resume \
		--tenx_min_umi_per_cell 10000 \
		--molecules dayhoff \
		--track_abundance \
		--ksizes 27,30,33,36,39,42,45,48,51,54,57,60,63 \
		--skip_compute \
		--skip_compare \
		--max_cpus 20 \
		--max_memory 16.GB \
		--max_time 400.h \
		--sketch_scaled 10

run_kmermaid_lung_ribosome_rna_remove:
	nextflow run nf-core/kmermaid \
		-r pranathivemuri-patch-1 \
		-latest \
		--read_singles '/data_lg/pranathi/immune-evolution/human-kmermaid-ndnd-september15/10x-fastqs/per-cell/*lung*/*.fastq.gz' \
		--reference_proteome_fasta /data_lg/olga/czbiohub-reference/uniprot/releases/2019_11/manually_downloaded/uniprot-reviewed_yes+taxonomy_Mammalia_9MAMM_40674.fasta.gz \
		--translate_peptide_ksize 11 \
		--translate_peptide_molecule protein \
		-with-tower \
		-work-dir /data_lg/pranathi/human-kmermaid-lung-oct5/ \
		--outdir /data_lg/pranathi/immune-evolution/human-kmermaid-lung-oct8 \
		-resume \
		--tenx_min_umi_per_cell 10000 \
		--molecules dayhoff \
		--track_abundance \
		--ksizes 27,30,33,36,39,42,45,48,51,54,57,60,63 \
		--skip_compute \
		--skip_compare \
		--max_cpus 20 \
		--max_memory 16.GB \
		--max_time 400.h \
		--sketch_scaled 10 \
		--skip_multiqc \
		--remove_ribo_rna \
		--save_non_rrna_reads \
